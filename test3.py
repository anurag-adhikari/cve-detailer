import pandas as pd
import csv
import re
#initial Data
import csv

def regexparse(datapara,regexpatt):
    ereg = '(?<='+regexpatt+').*'
    matches = re.finditer(ereg, datapara, re.MULTILINE | re.IGNORECASE)
    for matchNum, match in enumerate(matches, start=1):
        return match.group()

with open('data.csv', newline='') as csvfile:
    data = list(csv.reader(csvfile))
#working file creation
f = open("test.csv", "w")
f.close()
#Adding Columns to the newdf
newdf = pd.DataFrame(columns=['ID', 'Modified', 'Published', 'Authentication', 'Complexity', 'Vector', 'Assigner', 'Name', 'Prerequisites', 'Solutions','Summary'])
#print(data.head())
#looping for all the values of cve obtained
# for i in range(len(data)):
for i in range(2):
    #print (data[i][0])
    weburl = "https://cve.circl.lu/api/cve/" + data[i][0]
    #print(weburl)
    import json, urllib.request, requests
    #parsing all requests
    with urllib.request.urlopen(weburl) as response:
        html = json.loads(response.read())
    html = str(html)
    #print(html)
    print(regexparse(html, "Modified\": "))
   
    

    # fdatas = newdf.append({'ID': data[i][0], 'Modified':html['Modified'], 'Published':html['Published'],\
    # 'Authentication':html['access']['authentication'], 'Complexity':html['access']['complexity'],\
    # 'Vector':html['access']['vector'], 'Assigner':html['assigner'], 'Name':html['capec'][1]['name'],\
    # 'Prerequisites':html['capec'][1]['prerequisites'], 'Solutions':html['capec'][1]['solutions'],'Summary':html['capec'][1]['summary']} , ignore_index=True)
    # print(fdatas)

